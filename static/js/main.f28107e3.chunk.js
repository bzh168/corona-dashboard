(this["webpackJsonpcorona-dashboard-ts"]=this["webpackJsonpcorona-dashboard-ts"]||[]).push([[0],{366:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(44),i=n(77),s=n(92),d=n(30),o=n(186),l=n(207),u="https://api.corona-zahlen.org/states/history/pattern",j={FETCH_DATA:"FETCH_DATA",GOT_DATA:"GOT_DATA",GOT_META:"GOT_META",SET_SELECTEDS:"SET_SELECTEDS",SET_TIME_Range:"SET_TIME_Range",SET_SUM:"SET_SUM",FETCH_EVERY_HOUR:"FETCH_EVERY_HOUR"};var b=n(25),h=n(43),f=n.n(h),p=n(123),O=n(35);function x(e){if(e.ok)return e;throw new Error(e.statusText)}function m(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.assign(t,{credentials:"same-origin"}),fetch(e,t).catch((function(e){throw new Error(e.messge)})).then(x)}(e,{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.json()}))}var g=function(){return Object(s.b)()},v=s.c,y=f.a.mark(H),w=f.a.mark(I),_=f.a.mark(M),k=f.a.mark(z);function E(e,t){return e[t]}function T(e){return{week_4:e.reduce((function(e,t){return e+t})),week_3:e.slice(7).reduce((function(e,t){return e+t})),week_2:e.slice(14).reduce((function(e,t){return e+t})),week_1:e.slice(21).reduce((function(e,t){return e+t}))}}function S(e){return Object.entries(e.data).map((function(e){return{deaths:T(e[1].history.map((function(e){return e.deaths}))),id:e[1].id-1,name:e[1].name,region:e[0]}}))}function R(e){return Object.entries(e.data).map((function(e){return{recovered:T(e[1].history.map((function(e){return e.recovered}))),id:e[1].id-1,name:e[1].name,region:e[0]}}))}var A=function(e,t){return e.map((function(e){return{id:e.id,region:e.region,name:e.name,cases:E(e.cases,t),deaths:E(e.deaths,t),recovered:E(e.recovered,t)}}))},C=function(e,t){return e.map((function(e){return E(e,t)})).reduce((function(e,t){return e+t}))},D=function(e,t){return{cases:C(E(e,t),"cases"),deaths:C(E(e,t),"deaths"),recovered:C(E(e,t),"recovered")}};function H(){var e,t,n,a,r;return f.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(O.a)(m,u.replace("pattern","cases/28"));case 2:return e=c.sent,i=e,t=Object.entries(i.data).map((function(e){return{cases:T(e[1].history.map((function(e){return e.cases}))),id:e[1].id-1,name:e[1].name,region:e[0]}})),c.t0=S,c.next=7,Object(O.a)(m,u.replace("pattern","deaths/28"));case 7:return c.t1=c.sent,n=(0,c.t0)(c.t1),c.t2=R,c.next=12,Object(O.a)(m,u.replace("pattern","recovered/28"));case 12:return c.t3=c.sent,a=(0,c.t2)(c.t3),r=t.map((function(e,t){return Object(p.a)(Object(p.a)(Object(p.a)({},e),n[t]),a[t])})),c.abrupt("return",[{week_1:A(r,"week_1"),week_2:A(r,"week_2"),week_3:A(r,"week_3"),week_4:A(r,"week_4")},e.meta]);case 16:case"end":return c.stop()}var i}),y)}function I(){var e,t,n,a,r;return f.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(O.a)(H);case 2:return e=c.sent,t=Object(b.a)(e,2),n=t[0],a=t[1],c.next=8,Object(O.c)({type:j.GOT_DATA,payload:{data:n}});case 8:return c.next=10,Object(O.c)({type:j.GOT_META,payload:{meta:a}});case 10:return r={week_1:D(n,"week_1"),week_2:D(n,"week_2"),week_3:D(n,"week_3"),week_4:D(n,"week_4")},c.next=13,Object(O.c)({type:j.SET_SUM,payload:{sum:r}});case 13:return c.next=15,Object(O.c)({type:j.FETCH_EVERY_HOUR});case 15:case"end":return c.stop()}}),w)}function M(){var e,t;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(O.b)(36e5);case 2:return n.next=4,Object(O.a)(m,u.replace("pattern","cases/1"));case 4:return e=n.sent,n.next=7,Object(O.d)((function(e){return e.getIn(["meta","lastUpdate"])}));case 7:if(t=n.sent,e.meta.lastUpdate===t){n.next=11;break}return n.next=11,Object(O.a)(I);case 11:return n.next=13,Object(O.c)({type:j.FETCH_EVERY_HOUR});case 13:case"end":return n.stop()}}),_)}function z(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.e)(j.FETCH_DATA,I);case 2:return e.next=4,Object(O.f)(j.FETCH_EVERY_HOUR,M);case 4:case"end":return e.stop()}}),k)}var N=n(11),L=n(393),U=n(408),F=n(409),G=n(411),K=n(407),J=n(410),B=n(394),P=n(368),V=n(396),Y=n(400),W=n(399),q=n(395),Q=n(397),X=n(398),Z=n(417),$=n(413);function ee(e){return{type:j.SET_SELECTEDS,payload:{selecteds:e}}}var te=n(4);function ne(e,t,n){return t[n]<e[n]?-1:(t[n],e[n],1)}function ae(e,t){return"desc"===e?function(e,n){return ne(e,n,t)}:function(e,n){return-ne(e,n,t)}}var re=[{id:"name",numeric:!1,disablePadding:!0,label:"Region"},{id:"cases",numeric:!0,disablePadding:!1,label:"Cases"},{id:"deaths",numeric:!0,disablePadding:!1,label:"Deaths"},{id:"recovered",numeric:!0,disablePadding:!1,label:"Recovered"}],ce=Object(L.a)((function(){return{root:{width:"100%"},th:{"padding-left":0},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function ie(){var e=ce(),t=r.a.useState("asc"),n=Object(b.a)(t,2),c=n[0],i=n[1],s=r.a.useState("region"),o=Object(b.a)(s,2),l=o[0],u=o[1],h=v((function(e){return e.get("timeRange")})),f=v((function(e){return e.getIn(["data",h],void 0)})),p=g();Object(a.useEffect)((function(){p({type:j.FETCH_DATA})}),[]);var O=v((function(e){return e.get("selecteds",d.a.List())}));if(!f)return null;var x,m,y=f.toJS();return Object(te.jsx)(B.a,{container:!0,className:e.root,spacing:1,direction:"column",children:Object(te.jsx)(q.a,{children:Object(te.jsxs)(V.a,{"aria-labelledby":"tableTitle","aria-label":"enhanced table",size:"small",stickyHeader:!0,children:[Object(te.jsx)(Q.a,{children:Object(te.jsxs)(X.a,{children:[Object(te.jsx)(W.a,{className:e.th,children:Object(te.jsx)($.a,{indeterminate:O.size>0&&O.size<y.length,checked:y.length>0&&O.size===y.length,onChange:function(e){if(e.target.checked){if(O.size!==y.length&&0!==O.size)return void p(ee(d.a.List()));p(ee(d.a.List(y.map((function(e){return e.id})))))}else p(ee(d.a.List()))},inputProps:{"aria-label":"select all desserts"},size:"small"})}),re.map((function(t){return Object(te.jsx)(W.a,{className:e.th,align:t.numeric?"right":"left",padding:t.disablePadding?"none":"default",sortDirection:l===t.id&&c,children:Object(te.jsxs)(Z.a,{active:l===t.id,direction:l===t.id?c:"asc",onClick:function(e){return n=t.id,i(l===n&&"asc"===c?"desc":"asc"),void u(n);var n},children:[t.label,l===t.id?Object(te.jsx)("span",{className:e.visuallyHidden,children:"desc"===c?"sorted descending":"sorted ascending"}):null]})},t.id)}))]})}),Object(te.jsx)(Y.a,{children:(x=y,m=ae(c,l),x.sort((function(e,t){return m(e,t)}))).map((function(t){var n=O.includes(t.id),a="enhanced-table-checkbox-".concat(t.id);return Object(te.jsxs)(X.a,{hover:!0,onClick:function(e){return function(e,t){var n=O.includes(t)?O.delete(O.indexOf(t)):O.push(t);p(ee(n))}(0,t.id)},role:"checkbox","aria-checked":n,tabIndex:-1,selected:n,children:[Object(te.jsx)(W.a,{className:e.th,children:Object(te.jsx)($.a,{checked:n,inputProps:{"aria-labelledby":a},size:"small"})}),Object(te.jsx)(W.a,{component:"th",id:a,scope:"row",padding:"none",children:t.name}),Object(te.jsx)(W.a,{align:"right",children:t.cases}),Object(te.jsx)(W.a,{align:"right",children:t.deaths}),Object(te.jsx)(W.a,{align:"right",children:t.recovered})]},t.id)}))})]})})})}var se=n(401),de=n(402),oe=n(406),le=n(200),ue=n(201),je=n(98),be=n(94),he=n(208);function fe(){var e=v((function(e){return e.get("timeRange")})),t=v((function(t){return t.getIn(["data",e],void 0)})),n=v((function(e){return e.get("selecteds",d.a.List())})),r=Object(a.useState)(!0),c=Object(b.a)(r,2),i=c[0],s=c[1],o=Object(a.useState)(!0),l=Object(b.a)(o,2),u=l[0],j=l[1],h=Object(a.useState)(!0),f=Object(b.a)(h,2),p=f[0],O=f[1];if(!t)return null;var x=!!(n.size<7&&0!==n.size),m=n&&0!==n.size?t.filter((function(e){return n.includes(e.get("id"))})).toJS():t.toJS(),g=[{color:"#8884d8",dataKey:"cases",inactive:!i,type:"rect",value:"cases"},{color:"red",dataKey:"deaths",inactive:!u,type:"rect",value:"deaths"},{color:"#82ca9d",dataKey:"recovered",inactive:!p,type:"rect",value:"recovered"}];return Object(te.jsx)(se.a,{width:"100%",height:"100%",children:Object(te.jsxs)(de.a,{width:500,height:300,data:m,margin:{top:5,right:30,left:20,bottom:5},children:[Object(te.jsx)(oe.a,{strokeDasharray:"3 3"}),Object(te.jsx)(le.a,{dataKey:x?"name":"region"}),Object(te.jsx)(ue.a,{}),x?Object(te.jsx)(je.a,{}):Object(te.jsx)(je.a,{labelFormatter:function(e){var t=m.find((function(t){return t.region===e}));return t?t.name:null}}),Object(te.jsx)(be.a,{onClick:function(e){switch(e.dataKey){case"cases":s(!i);break;case"deaths":j(!u);break;case"recovered":O(!p)}},payload:g}),i?Object(te.jsx)(he.a,{dataKey:"cases",fill:"#8884d8"}):null,u?Object(te.jsx)(he.a,{dataKey:"deaths",fill:"red"}):null,p?Object(te.jsx)(he.a,{dataKey:"recovered",fill:"#82ca9d"}):null]})})}var pe=n(415),Oe=n(202),xe=n(119),me=["#2196f3","#e91e63","#ff9800","#673ab7","#3f51b5","#ffeb3b","#f44336","#ffc107","#009688","#9c27b0","#8bc34a","#cddc39","#00bcd4","#ff5722","#03a9f4","#4caf50"],ge=Math.PI/180,ve=function(e){var t=e.cx,n=e.cy,a=e.midAngle,r=e.innerRadius,c=e.outerRadius,i=e.percent,s=r+1.3*(c-r),d=t+s*Math.cos(-a*ge),o=n+s*Math.sin(-a*ge);return Object(te.jsx)("text",{x:d,y:o,fill:"black",textAnchor:d>t?"start":"end",dominantBaseline:"central",children:"".concat((100*i).toFixed(0),"%")})};function ye(){var e=g(),t=v((function(e){return e.get("timeRange")})),n=v((function(e){return e.getIn(["data",t],void 0)})),a=v((function(e){return e.get("selecteds",d.a.List())})),r=v((function(e){return e.getIn(["sum",t],void 0)}));if(!n)return null;var c=a&&0!==a.size?n.filter((function(e){return a.includes(e.get("id"))})).toJS():n.toJS();if(0!==a.size){var i=function(e){return e.reduce((function(e,t){return{cases:e.cases+t.cases,deaths:e.deaths+t.deaths,recovered:e.recovered+t.recovered}}),{cases:0,deaths:0,recovered:0})}(c);c.unshift({id:20,name:"others",region:"other",cases:r.get("cases")-i.cases,deaths:r.get("deaths")-i.deaths,recovered:r.get("recovered")-i.recovered})}var s=c.map((function(e,t){return{color:me[t],inactive:!1,type:"rect",value:e.name,id:e.id,tooltip:"click to remove"}}));return Object(te.jsx)(se.a,{width:"100%",height:"100%",children:Object(te.jsxs)(pe.a,{width:400,height:400,children:[Object(te.jsx)("text",{x:"5%",y:"6%",fill:"#8884d8",children:"Cases:"}),Object(te.jsx)(Oe.a,{data:c,cx:"20%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"cases",label:ve,children:c.map((function(e,t){return Object(te.jsx)(xe.a,{fill:me[t%me.length]},"cell-".concat(e.id))}))}),Object(te.jsx)("text",{x:"35%",y:"6%",fill:"red",children:"Deaths:"}),Object(te.jsx)(Oe.a,{data:c,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"deaths",label:ve,children:c.map((function(e,t){return Object(te.jsx)(xe.a,{fill:me[t%me.length]},"cell-".concat(e.id))}))}),Object(te.jsx)("text",{x:"65%",y:"6%",fill:"#82ca9d",children:"Recovered:"}),Object(te.jsx)(Oe.a,{data:c,cx:"80%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"recovered",label:ve,children:c.map((function(e,t){return Object(te.jsx)(xe.a,{fill:me[t]},"cell-".concat(e.id))}))}),Object(te.jsx)(je.a,{}),Object(te.jsx)(be.a,{payload:s,onClick:function(t){if(20!==t.id)if(0===a.size){var n=Array.from(Array(16).keys());n.splice(t.id,1),e(ee(d.a.List(n)))}else e(ee(a.delete(a.indexOf(t.id))))}})]})})}function we(){var e=v((function(e){return e.get("timeRange")})),t=v((function(t){return t.getIn(["sum",e],void 0)})),n=v((function(e){return e.getIn(["meta","lastUpdate"])})),r=Object(a.useMemo)((function(){return e?"week_1"===e?"In last week":"In past ".concat(e.slice(-1)," weeks"):null}),[e]),c=Object(a.useMemo)((function(){return new Date(n)}),[n]);return t?Object(te.jsxs)(K.a,{variant:"body2",color:"textSecondary",align:"center",children:[Object(te.jsxs)("span",{children:[r,", there are"," "]}),Object(te.jsxs)("span",{children:[t.get("cases")," ","cases,"," "]}),Object(te.jsxs)("span",{children:[t.get("deaths")," ","deaths,"," "]}),Object(te.jsxs)("span",{children:[t.get("recovered")," ","recovereds in Germany."," "]}),Object(te.jsx)("br",{}),Object(te.jsxs)("span",{children:["Updated:",c.toString()]})]}):null}var _e=n(416),ke=Object(L.a)((function(){return{sliderContainer:{display:"flex"},slider:{marginLeft:"auto",marginRight:"5%",width:"60%"}}}));function Ee(){var e=ke(),t=g(),n=v((function(e){return e.get("timeRange")}));return Object(te.jsx)("div",{className:e.sliderContainer,children:Object(te.jsx)(_e.a,{className:e.slider,track:"inverted",value:"string"===typeof n?4-parseInt(n.split("_")[1],10):3,max:4,min:0,marks:[{value:0,label:"4 weeks"},{value:1,label:"3 weeks"},{value:2,label:"2 weeks"},{value:3,label:"1 week"},{value:4,label:"Now"}],onChange:function(e,n){4!==n&&"number"===typeof n&&t(function(e){return{type:j.SET_TIME_Range,payload:{timeRange:e}}}("week_".concat(4-n)))}})})}var Te=Object(L.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1,width:"100%",flexDirection:"row",alignItems:"center",paddingLeft:40,paddingRight:40,paddingTop:10,paddingBottom:10,justifyContent:"space-between"},appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:0,paddingBottom:0},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"},fixedHeight:{height:400},fixedHeight2:{height:750}}}));function Se(){var e=Te(),t=Object(N.a)(e.paper,e.fixedHeight),n=Object(N.a)(e.paper,e.fixedHeight2);return Object(te.jsxs)("div",{className:e.root,children:[Object(te.jsx)(U.a,{}),Object(te.jsx)(F.a,{position:"absolute",className:e.appBar,children:Object(te.jsx)(K.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,children:"Corona-Dashboard"})}),Object(te.jsxs)("main",{className:e.content,children:[Object(te.jsx)("div",{className:e.appBarSpacer}),Object(te.jsxs)(J.a,{maxWidth:"xl",className:e.container,children:[Object(te.jsxs)(B.a,{container:!0,spacing:1,children:[Object(te.jsxs)(B.a,{item:!0,xs:12,md:5,lg:5,children:[Object(te.jsx)(P.a,{children:Object(te.jsx)(Ee,{})}),Object(te.jsx)(P.a,{className:n,children:Object(te.jsx)(ie,{})})]}),Object(te.jsxs)(B.a,{item:!0,xs:12,md:7,lg:7,children:[Object(te.jsx)(P.a,{className:t,children:Object(te.jsx)(fe,{})}),Object(te.jsx)(P.a,{className:t,children:Object(te.jsx)(ye,{})})]})]}),Object(te.jsx)(G.a,{pt:2,children:Object(te.jsx)(we,{})})]})]})]})}var Re=Object(l.a)(),Ae=Object(i.createStore)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.a.Map(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j.GOT_DATA:return e.set("data",d.a.fromJS(t.payload.data));case j.GOT_META:return e.set("meta",d.a.fromJS(t.payload.meta));case j.SET_SELECTEDS:return e.set("selecteds",t.payload.selecteds);case j.SET_TIME_Range:return e.set("timeRange",t.payload.timeRange);case j.SET_SUM:return e.set("sum",d.a.fromJS(t.payload.sum));default:return e}}),d.a.Map({meta:{},timeRange:"week_1"}),Object(o.composeWithDevTools)(Object(i.applyMiddleware)(Re)));Re.run(z),Object(c.render)(Object(te.jsx)(s.a,{store:Ae,children:Object(te.jsx)(Se,{})}),document.getElementById("root"))}},[[366,1,2]]]);
//# sourceMappingURL=main.f28107e3.chunk.js.map